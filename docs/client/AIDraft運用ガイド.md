# AIDraft 運用ガイド

## 🚀 初期設定（1回のみ）

### 1. 自動実行トリガーの設定
各プロジェクトで以下を実行：

```javascript
setupTrigger(); // 1時間ごとの自動実行開始
```

### 2. OpenAI APIキーの設定
1. GASエディタ → 「プロジェクトの設定」
2. 「スクリプト プロパティ」タブ
3. プロパティ: `OPENAI_API_KEY`
4. 値: APIキーを入力

### 3. 動作確認
```javascript
testSingleRow(); // テスト実行で動作確認
```

## 📋 日常運用

### Gmail下書きの確認・送信
1. **Gmailの下書きフォルダを開く**
2. **ラベルで絞り込み**
   - "AI自動回答_お問い合わせ"
   - "AI自動回答_単発"  
   - "AI自動回答_WeekendEnt"
   - "AI自動回答_Gmail"
3. **下書き内容を確認・編集**
4. **送信**

### 04_Gmailラベル手動処理
1. **処理したいメールに手動でラベル付け**
   - ラベル名: "AI回答要求"
2. **自動処理を待つ（1時間ごと）**
   - または手動で `processLabeledEmails()` 実行
3. **下書きが作成されたら確認・送信**

### 処理状況の確認
**スプレッドシートで確認**
- **01_お問い合わせ**: G列（ステータス）+ H列（統合情報）
- **02_単発**: I列（ステータス）+ J列（統合情報）
- **03_WeekendEnt**: H列（ステータス）+ I列（統合情報）

### 自動実行の管理
```javascript
// 停止
deleteTriggers();

// 再開
setupTrigger();
```

## 🔧 基本情報

### システム構成
- **01_お問い合わせ**: 問い合わせ自動返信システム
- **02_単発**: 単発アンケート自動回答システム  
- **03_WeekendEnt**: WeekendEnt自動回答システム
- **04_Gmailラベル自動回答**: Gmail手動ラベルによるAI下書き作成システム

### 重要な関数
| 関数 | 用途 |
|---|---|
| `setupTrigger()` | 自動実行開始 |
| `deleteTriggers()` | 自動実行停止 |
| `testSingleRow()` | 動作テスト（01～03用） |
| `testSingleEmail()` | 動作テスト（04用） |
| `processInquiries()` | 手動一括処理（01用） |
| `processTanbatsu()` | 手動一括処理（02用） |
| `processWeekendEnt()` | 手動一括処理（03用） |
| `processLabeledEmails()` | 手動一括処理（04用） |

## 🚨 トラブル時の対応

### 処理が動かない場合
1. ✅ APIキーが設定されているか
2. ✅ トリガーが有効か（⏰マークで確認）
3. ✅ 未処理データがあるか
4. ✅ Gmail権限が許可されているか

### 下書きが作成されない場合
1. ✅ メールアドレスが正しく入力されているか
2. ✅ エラーメッセージを確認
3. ✅ 手動テスト実行で問題を特定

### AI回答の品質について
- 不適切な回答は下書きを編集してから送信
- 専門的な内容は人手での確認を推奨

## 💰 料金について
- **OpenAI API**: 1件あたり0.1-0.3円程度
- **Google Apps Script**: 基本無料
- **使用量確認**: OpenAIダッシュボード

## 📞 サポート
問題発生時は以下の情報を添えて連絡：
- エラーメッセージ
- 発生日時
- どのプロジェクトか
- 処理データの概要