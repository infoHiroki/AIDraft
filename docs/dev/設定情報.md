# 設定情報

## APIキー設定

### OpenAI API
- **設定場所**: GAS → プロジェクト設定 → スクリプトプロパティ
- **キー名**: `OPENAI_API_KEY`
- **値**: OpenAI APIキー（sk-proj-...）
- **モデル**: `gpt-4o-mini`

## スプレッドシート設定

### 01_お問い合わせ
- **ID**: クライアント環境のスプレッドシートID
- **シート名**: `お問い合わせ`
- **処理対象**: F列（質問）があり、G列（ステータス）が空
- **出力先**: G列（ステータス）+ H列（統合情報）
- **ラベル名**: `AI自動回答_お問い合わせ`

### 02_単発
- **ID**: クライアント環境のスプレッドシートID
- **シート名**: `単発`
- **処理対象**: H列（質問）があり、I列（ステータス）が空
- **出力先**: I列（ステータス）+ J列（統合情報）
- **ラベル名**: `AI自動回答_単発`

### 03_WeekendEnt
- **ID**: クライアント環境のスプレッドシートID（02と同じ）
- **シート名**: `WeekendEnt`
- **処理対象**: G列（質問）があり、H列（ステータス）が空
- **出力先**: H列（ステータス）+ I列（統合情報）
- **ラベル名**: `AI自動回答_WeekendEnt`

## システム設定

### 処理制限
- **1回の最大処理件数**: 20件
- **自動実行間隔**: 1時間（setupTrigger()使用時）
- **タイムアウト**: Google Apps Script 6分制限

### Gmail設定
- **送信者**: 実行ユーザーのGmailアカウント
- **下書きラベル**: 自動作成・付与
- **自動送信**: なし（下書きのみ）
- **件名**: "Re: セミナーについてのご質問"

### 統合出力形式
```
2025/06/09 14:25
Draft ID: abc123def456
────────────────
[AI生成回答内容]
```

## プロジェクト別関数

### 01_お問い合わせ
- **メイン処理**: `processInquiries()` - 未処理問い合わせを最大20件まで自動処理
- **テスト実行**: `testSingleRow()` - 1件のみ処理してテスト実行として記録
- **設定確認**: `checkConfig()` - APIキー設定、シート接続状況の確認
- **トリガー設定**: `setupTrigger()` - 1時間ごとの定期実行トリガーを作成
- **トリガー削除**: `deleteTriggers()` - processInquiries用のトリガーを全削除

### 02_単発
- **メイン処理**: `processTanbatsu()` - 未処理質問を最大20件まで自動処理
- **テスト実行**: `testTanbatsuSingleRow()` - 1件のみ処理してテスト実行として記録
- **設定確認**: `checkConfig()` - APIキー設定、シート接続状況の確認
- **トリガー設定**: `setupTrigger()` - 1時間ごとの定期実行トリガーを作成
- **トリガー削除**: `deleteTriggers()` - processTanbatsu用のトリガーを全削除

### 03_WeekendEnt
- **メイン処理**: `processWeekendEnt()` - 未処理質問を最大20件まで自動処理
- **テスト実行**: `testWeekendEntSingleRow()` - 1件のみ処理してテスト実行として記録
- **設定確認**: `checkConfig()` - APIキー設定、シート接続状況の確認
- **トリガー設定**: `setupTrigger()` - 1時間ごとの定期実行トリガーを作成
- **トリガー削除**: `deleteTriggers()` - processWeekendEnt用のトリガーを全削除

## 内部アーキテクチャ関数

### Service系（共通）
- **AIService.generateSeminarQuestionResponse()** - AI回答生成
- **GmailService.createDraft()** - Gmail下書き作成とラベル付与
- **SheetService.updateStatus()** - 統合出力形式でステータス更新

### Processor系（プロジェクト別）
- **DentalSeminarProcessor.process()** - 01_お問い合わせ用業務ロジック
- **TanbatsuProcessor.process()** - 02_単発用業務ロジック
- **WeekendEntProcessor.process()** - 03_WeekendEnt用業務ロジック