# AIDraft プロジェクト比較表（V2.1統合版対応）

> **注意**: 本文書は旧版（01-04独立プロジェクト）の比較表です。  
> **現行版**: sheets/統合プロジェクト + gmail/プロジェクトの2つの統合システム  
> **V2.1**: 統合管理シート方式による処理状況管理を実装済み

## 基本情報比較（旧版 vs V2.1統合版）

### 旧版（独立プロジェクト）
| 項目 | 01_お問い合わせ | 02_その他セミナー | 03_WeekendEnt | 04_Gmailラベル自動回答 |
|---|---|---|---|---|
| **入力元** | Googleフォーム | Googleフォーム | Googleフォーム | Gmail受信メール |
| **データ保存** | スプレッドシート | スプレッドシート | スプレッドシート | Gmail（ラベル管理） |
| **処理対象** | お問い合わせ内容 | セミナー質問 | WeekendEnt質問 | 受信メール全体 |
| **回答特化** | 歯科セミナー | その他セミナー | WeekendEnt | 汎用メール |

### V2.1統合版（現行）
| 項目 | sheets/プロジェクト | gmail/プロジェクト |
|---|---|---|
| **入力元** | 3つのGoogleフォーム（統合管理） | Gmail受信メール |
| **データ保存** | 1つの統合スプレッドシート + AI処理管理シート | Gmail（ラベル管理） |
| **処理対象** | 3シート（お問い合わせ・その他セミナー・WeekendEnt） | 受信メール全体 |
| **処理方式** | 統合管理シートによる処理状況管理 | ラベルベース管理 |

## 技術仕様比較（旧版 vs V2.1統合版）

### 旧版（独立プロジェクト）
| 項目 | 01_お問い合わせ | 02_その他セミナー | 03_WeekendEnt | 04_Gmailラベル自動回答 |
|---|---|---|---|---|
| **列検索方式** | 固定インデックス | 固定 + 動的AI列 | 完全動的 | N/A（Gmail） |
| **ヘッダー行** | 1行目 | 1行目 | 2行目 | N/A |
| **処理件数/回** | 最大20件 | 最大20件 | 最大20件 | 最大10件 |
| **コード複雑度** | 標準 | 簡潔化（44行） | 高（動的処理） | 中（ラベル処理） |

### V2.1統合版（現行）
| 項目 | sheets/プロジェクト | gmail/プロジェクト |
|---|---|---|
| **処理方式** | 統合管理シートベース | ラベルベース |
| **列構成** | 固定列マッピング（設定駆動） | N/A（Gmail） |
| **処理件数/回** | 各シート最大20件 | 最大10件 |
| **コード複雑度** | 中（統合処理だが設定駆動） | 中（ラベル処理） |
| **フォーム拡張対応** | 無制限（データ分離方式） | N/A |

## スプレッドシート構成比較

### 01_お問い合わせ
```
A: Timestamp | B: Email | C: 歯科医院名 | D: お問い合わせ[処理対象] | E: 事務局対応[ステータス] | F: AI回答
```

### 02_その他セミナー  
```
A: Timestamp | B: Email | C: 歯科医院名 | D: 先生名 | E: 感想 | F: 事務局対応[ステータス] | G: 質問[処理対象] | ?: AI回答[動的]
```

### 03_WeekendEnt
```
[すべて動的] | Email | 事務局対応[ステータス] | 質問[処理対象] | AI回答[動的] | その他項目...
```

## 処理方式比較

| 項目 | 01_お問い合わせ | 02_その他セミナー | 03_WeekendEnt | 04_Gmailラベル自動回答 |
|---|---|---|---|---|
| **データ取得** | 固定列参照 | 固定列参照 | 動的ヘッダー検索 | Gmail API |
| **処理判定** | D列有・E列空 | G列有・F列空 | 質問列有・対応列空 | ラベル条件 |
| **ステータス更新** | 固定列書込 | 直接セル更新 | 動的列書込 | ラベル付与 |
| **AI列管理** | 固定F列 | 動的追加 | 動的追加 | N/A |

## Gmail設定比較

| 項目 | 01_お問い合わせ | 02_その他セミナー | 03_WeekendEnt | 04_Gmailラベル自動回答 |
|---|---|---|---|---|
| **ラベル名** | AI自動回答_歯科セミナー | AI自動回答_その他セミナー | AI自動回答_WeekendEnt | 設定可能 |
| **下書き形式** | 新規メール | 新規メール | 新規メール | 返信メール |
| **送信先** | フォーム入力者 | フォーム入力者 | フォーム入力者 | 元送信者 |

## AI回答生成比較

### 入力データ構造
**01_お問い合わせ**
```javascript
{ email, clinicName, inquiry }
```

**02_その他セミナー**  
```javascript
{ email, clinicName, doctorName, impression, question }
```

**03_WeekendEnt**
```javascript
{ email, question, ...allFormData }  // 動的
```

**04_Gmailラベル自動回答**
```javascript
{ from, subject, body, date }
```

## 開発・保守性比較

| 項目 | 01_お問い合わせ | 02_その他セミナー | 03_WeekendEnt | 04_Gmailラベル自動回答 |
|---|---|---|---|---|
| **コード保守性** | 高（シンプル） | 最高（簡潔化） | 中（複雑だが柔軟） | 高（標準的） |
| **フォーム変更対応** | 低（固定列） | 中（AI列のみ動的） | 高（完全動的） | N/A |
| **デバッグ容易性** | 高 | 高 | 中 | 中 |
| **テスト実行** | 簡単 | 簡単 | やや複雑 | 簡単 |

## 運用特性比較（旧版 vs V2.1統合版）

### 旧版（独立プロジェクト）
| 項目 | 01_お問い合わせ | 02_その他セミナー | 03_WeekendEnt | 04_Gmailラベル自動回答 |
|---|---|---|---|---|
| **安定性** | 高 | 高 | 中（動的処理） | 中（Gmail依存） |
| **拡張性** | 低 | 中 | 高 | 中 |
| **エラー耐性** | 高 | 高 | 中 | 中 |
| **パフォーマンス** | 高 | 高 | 中（キャッシュあり） | 中 |

### V2.1統合版（現行）
| 項目 | sheets/プロジェクト | gmail/プロジェクト |
|---|---|---|
| **安定性** | 高（統合管理シート方式） | 中（Gmail依存） |
| **拡張性** | 最高（無制限フォーム対応） | 中 |
| **エラー耐性** | 高（データ分離により向上） | 中 |
| **パフォーマンス** | 高（設定駆動・効率化） | 中 |
| **保守性** | 高（1つのプロジェクトで3システム） | 高（標準的） |
| **監視性** | 最高（統合管理シート + 統計機能） | 中 |

## 推奨用途

### V2.1統合版の利点

#### sheets/プロジェクト（統合スプレッドシート処理）
- **統合管理**: 3つのシートを1つのシステムで効率管理
- **無制限拡張**: フォーム項目数に制限なし（管理シート方式）
- **データ安全性**: フォームデータは読み取り専用、システムデータは分離
- **運用効率**: 1つのGASプロジェクトで3システム管理
- **処理状況の可視化**: 統合管理シートで一元監視

#### gmail/プロジェクト（Gmail処理）
- **メールベース処理**: 直接的なメール対応
- **汎用的な自動回答**: 柔軟なメール処理
- **包括的テスト**: 単体・統合テスト完備

### 旧版からの移行完了事項
- **374件のデータ移行完了**（2025年1月実施）
- **統合管理シート実装完了**
- **無制限フォーム拡張対応完了**
- **安全性向上**: データ上書きリスク完全排除